 (CNN)Sen. Ed Markey beat back a bid on Tuesday from Rep. Joe Kennedy to end his nearly 50 years in elected office, humbling the Democratic Party's family dynasty that had never before lost an election in Massachusetts.The longtime legislator won the primary by campaigning as the most progressive person in the race, while emphasizing his roots as the son of a milkman from Malden."We made it clear that we'd rather lose fighting as hard as we could for what we believe in than in finding the middle ground," said Markey in his victory speech. "The progressive movement knows how to fight. We will not surrender."About a year ago, when it became clear that the congressman would run, Markey visited his parents' gravesite, contemplated what to do and what his parents would do, and concluded he had to run for reelection, according to campaign manager John Walsh. His decision could've been described as foolish. Kennedy, 39, led in the polls from the get-go, launching a campaign focused on social and economic justice while offering a generational change to the 74-year-old Markey, who has served in Congress for over four decades.But his critics attacked Kennedy for not articulating a reason for running besides his own ambition, and Markey deflected his opponent's shine by projecting the power of some of the party's brightest stars. The two Democrats didn't disagree much on policy, but Markey established himself early on as the earliest adopter of liberal causes, pointing to his co-authorship of the Green New Deal and support of "Medicare for All." Markey wore retro-hip Nikes and aligned himself with New York Rep. Alexandria Ocasio-Cortez, the party phenom, and the Sunrise Movement, a youthful group focused on combating climate change, to show he was of the times"When it comes to progressive leadership, it's not your age that counts, it's the age of your ideas," Ocasio-Cortez said in an ad. "And Ed Markey is the leader that we need."Markey suggested that Kennedy was a legislative lightweight, while claiming that he himself has written hundreds of laws providing affordable internet to schools and libraries, raising fuel economy standards for cars and trucks, raising billions of dollars for Alzheimer's research and even deterring robocalls. He said he has led political revolutions since at least the 1980s, when he introduced the nuclear freeze resolution and nearly a million people gathered in New York's Central Park to demand an end to the nuclear arms race.Kennedy countered by poking holes in Markey's long record, including his votes for the Iraq War, NAFTA, the Patriot Act and the 1994 crime bill. Overall, Kennedy claimed that he would be a better senator, who could both deliver for his state and build the party across the country. He knocked Markey for spending less time at home in Massachusetts than any other member of the state's congressional delegation, even when Sen. Elizabeth Warren was running for president, citing a Boston Globe analysis.But by the last month of the campaign, as mail-in voting began, polls showed Markey had taken the lead. There were signs that Kennedy was frustrated. He told CNN in August that the coronavirus pandemic "without question hinders a challenger" since it limited his ability to connect in person with people, which he viewed as one of his advantages in the race. Still, a masked Kennedy went on a whirlwind tour across the state and picked up the endorsement of House Speaker Nancy Pelosi, who noted the congressman's cross-country effort in 2018 to flip the House.As the pandemic raged on, Markey inverted former President John F. Kennedy's famous call to action. "It's time to start asking what your country can do for you," he said. In response, Kennedy's campaign finally, explicitly portrayed him as the scion of a legacy shaped by former Attorney General Robert F. Kennedy, former President Kennedy and former Massachusetts Sen. Ted Kennedy, his grandfather and great-uncles. The narrator of one television ad said that the fights for health care for all, jobs and opportunity, and racial justice were "in his blood."But on Tuesday, Markey blocked Kennedy's path to the chamber where his fore-bearers once roamed. In his concession speech, Kennedy said his family had been "invoked far more often than I anticipated" and praised it for showing him the "example of what public service should be."He then told his two children, "If there's one message from your dad tonight, it's this: Always spend your life in the ring. It is worth the fight."This story has been updated with additional developments Tuesday night.