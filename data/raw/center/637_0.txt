DOHA, Qatar—The U.S. and the Taliban signed a historic deal Saturday meant to end America’s longest war and pave the way for Afghan factions to bring 18 years of costly fighting in their country to an end.To the shouts of “God is great” by Taliban leaders, a co-founder of the insurgent group and a top American diplomat shook hands on a plan that calls for the U.S. to pull all its forces out of Afghanistan over the next 14 months. In exchange, the Taliban pledged to discuss a long-term cease-fire with the Afghan government and to prevent militant groups like al Qaeda from using the country to plan strikes on the West—as         Osama bin Laden    did before ordering the Sept. 11, 2001 terrorist attacks. The ceremony marked one of the most significant attempts by President         Trump    to extricate the U.S. from what he calls America’s “endless wars” in the Middle East and South Asia.                                                 U.S. Secretary of State Mike Pompeo speaks during the agreement signing between Taliban and U.S. officials.                  Photo:            Hussein Sayed/Associated Press                                                                                                             Mr. Trump has railed against the trillions of dollars the U.S. spends on fighting overseas. He pulled most American troops out of Syria after the defeat of Islamic State’s self-proclaimed caliphate, and has pressed his national security team to find a way to end the war in Afghanistan.               Speaking at the White House on Saturday, Mr. Trump noted anew the sacrifice of U.S. blood and treasure in a long war and praised the latest accord. “It’s been a hard journey for everybody,” Mr. Trump said.     Mr. Trump said he would soon meet with Taliban leaders and looked forward to a drawdown of U.S. troops in Afghanistan. But he also said: “If bad things happen, we’ll go back.”     In Doha, U.S., Taliban and regional diplomats hailed the deal as a chance for Afghanistan to bring an end to nearly two decades of conflict, which has claimed more than 90,000 Afghan lives.     “This agreement will mean nothing—and today’s good feelings will not last—if we don’t take concrete action on commitments stated and promises made,” Secretary of State         Mike Pompeo    said in a tempered speech before the deal was signed.     The event marked the first time an American cabinet official has met with Taliban leaders who have overseen an insurgency that has killed 2,400 U.S. service members since 2001.         SHARE YOUR THOUGHTSWhat are the long-term prospects for this peace deal? Join the conversation below.        Mr. Pompeo sat in the front row as the deal was signed and didn’t clap along with other diplomats when Taliban leader Mullah Abdul Ghani Baradar delivered a short speech pledging to honor it.     Mr. Pompeo warmly greeted other diplomats during the event, but left the hall without shaking hands with the Taliban negotiator.     After the ceremony, Taliban leader Haibatullah Akhundzada issued a statement proclaiming the deal a victory for the group’s fight to end American “occupation” of Afghanistan.              Saad Mohseni,    who returned to Afghanistan in 2001 to launch the country’s most successful private media company, said Saturday’s deal was a milestone but didn’t mark the end of the war.     “Everyone has gone to Doha for the pomp and ceremony as if this is a victory lap, and that’s just not the case,” he said. “This is the beginning of the very beginning, with major challenges ahead.”     In practice, the agreement is designed to quickly reduce the number of American troops in Afghanistan from about 13,000 to 8,600—the level it was when Mr. Trump took office in 2017. America’s North Atlantic Treaty Organization allies will also scale back their military presence in Afghanistan and work with the U.S. to shutter five bases around the country.     Once the U.S. reaches that level, expected to happen over the next 135 days, a full U.S. troop withdrawal by June 2021 would be dependent on several conditions. Most important to the U.S., the Taliban have to honor their pledge to help prevent insurgent groups from trying to use the country to plan attacks against the U.S. and its allies.     The Taliban also agreed to discuss a permanent cease-fire in talks with the current Afghan government set to begin on March 10th.      Before those talks start, the U.S. agreed to help secure the release of 5,000 Taliban prisoners if the Taliban releases 1,000 detainees. Doing so in 10 days could be daunting. The Afghan government is fractured over the disputed presidential election that secured a second term for President         Ashraf Ghani.    The U.S. has not recognized his claim to winning the vote.     Mr. Ghani delayed his inauguration, planned for last Thursday, at the urging of U.S. officials worried that the event would increase tensions in Afghanistan, where challenger         Abdullah Abdullah    is contesting the outcome.     In an effort to demonstrate the U.S. commitment to the current Afghan government, Defense Secretary         Mark Esper    flew to Afghanistan on Saturday to sign a parallel agreement at the presidential palace in Kabul, where he said the Trump administration would walk away from the Taliban deal if the group didn’t honor its commitments.     Mr. Ghani sought to exude an aura of confidence, despite the unresolved challenges to the tarnished vote that secured his re-election.     “Today can be the moment of overcoming the past,” he said as Mr. Esper looked on. “Our people can mark it as the time when our quest for sustainable and dignified peace moved from desirability to feasibility.”                                                 Taliban leader Mullah Abdul Ghani Baradar pledged to honor the deal.                  Photo:            Hussein Sayed/Associated Press                                                                                                             Saturday’s deal marks the culmination of 18 months of tortuous talks led by Zalmay Khalilzad, the Afghan-American diplomat who served as U.S. ambassador in Afghanistan a few years after the Taliban were forced from power.     Mr. Trump tapped Mr. Khalilzad in 2018 to lead negotiations. Last September, those efforts broke down on the eve of secret talks that Mr. Trump planned to hold in the U.S. at Camp David with top Taliban leaders and Mr. Ghani.     Mr. Trump publicly broke off the plans days before they were supposed to begin and said he wouldn’t negotiate with the Taliban until they showed a commitment to ending their attacks.     When talks eventually resumed, the Taliban and U.S. agreed to a de facto seven-day cease-fire that dramatically cut violence across Afghanistan and paved the way for the two sides to sign Saturday’s deal.     Mr. Trump entered office in 2017 with a vow to end the war. At one point in 2010, under former President         Barack Obama,    the U.S. had 100,000 members of the military stationed in Afghanistan. By the time he left office in 2017, Mr. Obama has reduced the number to about 8,400.     Amid signs of a new Taliban resurgence in 2017, Mr. Trump raised the troop level and gave the military more freedom and firepower to fight the militant group, which responded by killing record numbers of civilians and Afghan forces.     Many Afghans hailed Saturday’s signing as a rare moment of promise after years of dashed hopes for peace. But there are widespread fears that the U.S. could lose leverage if it withdraws most of its troops, allowing the Taliban to extend influence across the country and whittle away at the progress the country has made in women’s rights and social freedoms.     “The Americans need to midwife the process all the way to the end,” said Mr. Mohseni, the media executive.     —Jessica Donati and Alex Leary contributed to this article.     Write to Dion Nissenbaum at dion.nissenbaum@wsj.com     Copyright ©2022 Dow Jones & Company, Inc. All Rights Reserved. 87990cbe856818d5eddac44c7b1cdeb8