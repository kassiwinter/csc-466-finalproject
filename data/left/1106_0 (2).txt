Credit...Jim Lo Scalzo/European Pressphoto AgencyDec. 16, 2013WASHINGTON — A federal district judge ruled on Monday that the National Security Agency program that is systematically keeping records of all Americans’ phone calls most likely violates the Constitution, describing its technology as “almost Orwellian” and suggesting that James Madison would be “aghast” to learn that the government was encroaching on liberty in such a way.The judge, Richard J. Leon of Federal District Court for the District of Columbia, ordered the government to stop collecting data on the personal calls of the two plaintiffs in the case and to destroy the records of their calling history. But Judge Leon, appointed to the bench in 2002 by President George W. Bush, stayed his injunction “in light of the significant national security interests at stake in this case and the novelty of the constitutional issues,” allowing the government time to appeal it, which he said could take at least six months. “I cannot imagine a more ‘indiscriminate’ and ‘arbitrary’ invasion than this systematic and high-tech collection and retention of personal data on virtually every single citizen for purposes of querying and analyzing it without prior judicial approval,” Judge Leon wrote in a 68-page ruling. “Surely, such a program infringes on ‘that degree of privacy’ that the founders enshrined in the Fourth Amendment,” which prohibits unreasonable searches and seizures.Andrew Ames, a Justice Department spokesman, said government lawyers were studying the decision, but he added: “We believe the program is constitutional as previous judges have found.”The case is the first in which a federal judge who is not on the Foreign Intelligence Surveillance Court, which authorized the once-secret program, has examined the bulk data collection on behalf of someone who is not a criminal defendant. The Justice Department has said that 15 separate judges on the surveillance court have held on 35 occasions that the calling data program is legal.It also marks the first successful legal challenge brought against the program since it was revealed in June after leaks by the former N.S.A. contractor Edward J. Snowden. In a statement from Moscow, where he has obtained temporary asylum, Mr. Snowden praised the ruling.“I acted on my belief that the N.S.A.’s mass surveillance programs would not withstand a constitutional challenge, and that the American public deserved a chance to see these issues determined by open courts,” Mr. Snowden said in his statement. It was distributed by Glenn Greenwald, a journalist who received leaked documents from Mr. Snowden and wrote the first article about the bulk data collection. “Today, a secret program authorized by a secret court was, when exposed to the light of day, found to violate Americans’ rights,” the statement said. “It is the first of many.”The case was brought by several plaintiffs led by Larry Klayman, a conservative legal activist. Mr. Klayman, who represented himself and the other plaintiffs, said in an interview on Monday that he was seeking to turn the case into a class action on behalf of all Americans. “I’m extremely gratified that Judge Leon had the courage to make this ruling,” he said. “He is an American hero.”Mr. Klayman argued that he had legal standing to challenge the program in part because, he contended, the government had sent inexplicable text messages to his clients on his behalf; at a hearing, he told the judge, “I think they are messing with me.”The judge portrayed that claim as “unusual” but looked past it, saying Mr. Klayman and his co-plaintiff instead had standing because it was highly likely, based on the government’s own description of the program as a “comprehensive metadata database,” that the N.S.A. collected data about their phone calls along with everyone else’s.Similar legal challenges to the N.S.A. program, including by the American Civil Liberties Union and the advocacy group Electronic Frontier Foundation, are at earlier stages in the courts. Last month, the Supreme Court declined to hear an unusual challenge to the program by the Electronic Privacy Information Center, which had sought to bypass lower courts. The ruling on Monday comes as several government panels are developing recommendations on whether to keep, restructure or scrap the bulk data collection program, and as Congress debates competing bills over the program’s future. Though long and detailed, Judge Leon’s ruling is not a final judgment on the program, but rather a preliminary injunction to stop the collection of data about the plaintiffs while they pursued their case. He also wrote that he had “serious doubts about the efficacy” of the program, saying that the government had failed to cite “a single instance in which analysis of the N.S.A.’s bulk metadata collection actually stopped an imminent attack, or otherwise aided the government in achieving any objective that was time-sensitive.” Judge Leon rejected the Obama administration’s argument that a 1979 case, Smith v. Maryland, had established there are no Fourth Amendment protections for call metadata — information like the numbers dialed and the date, time and duration of calls, but not their content. The 1979 case, which involved collecting information about a criminal defendant’s calls, helped establish the principle that people do not have a reasonable expectation of privacy for information they have exposed to a third party, like the phone company, which knows about their calls.The surveillance court, which issues secret rulings after hearing arguments from only the Justice Department and without opposing lawyers, has maintained that the 1979 decision is a controlling precedent that shields the N.S.A. call data program from Fourth Amendment review. But Judge Leon, citing the scope of the program and the evolving role of phones and technology, distinguished the bulk collection from the 34-year-old case.Last month, a federal judge declined to grant a new trial to several San Diego men convicted of sending money to a terrorist group in Somalia. Government officials have since acknowledged that investigators became interested in them because of the call records program. Citing Smith v. Maryland, the judge said the defendants had “no legitimate expectation of privacy” over their call data.David Rivkin, a White House lawyer in the administration of the elder President George Bush, criticized Judge Leon’s reasoning.“Smith v. Maryland is the law of the land,” Mr. Rivkin said. “It is not for a District Court judge to question the continuing validity of a Supreme Court precedent that is exactly on point.”Judge Leon also pointed to a landmark privacy case decided by the Supreme Court in 2012 that held it was unconstitutional for the police to use a GPS tracking device to monitor a suspect’s public movements without a warrant. Although the court decided the case on narrow grounds, five of the nine justices separately questioned whether the 1979 precedent was still valid in an era of modern technology, which enables long-term, automated collection of information.